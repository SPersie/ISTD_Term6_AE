setwd("~/Desktop/AE/Week4")
safety <- read.csv("safetydata.csv")
str(safety)
summary(safety)
head(safety)
table(safety$Choice)
which(colnames(safety)=="CC1")
which(colnames(safety)=="Price4")
library(mlogit)
install.packages("mlogit")
library(mlogit)
S <- mlogit.data(subset(safety, Task<=12), shape="wide", choice="Choice", varying =c(4:83), sep="", alt.levels=c("Ch1", "Ch2", "Ch3", "Ch4"), id.var="Case")
head(S)
str(S)
M <- mlogit(Choice~CC+GN+NS+BU+FA+LD+BZ+FC+FP+RP+PP+KA+SC+TS+NV+MA+LB+AF+HU+Price-1, data=S)
summary(M)
ActualChoice <- subset(safety, Task<=12)[,"Choice"]
P <- predict(M, newdata=S)
PredictedChoice <- apply(P,1,which.max)
table(PredictedChoice, ActualChoice)
M1 <- mlogit(Choice~CC+GN+NS+BU+FA+LD+BZ+FC+FP+RP+PP+KA+SC+TS+NV+MA+LB+AF+HU+Price-1, data=S, rpar=c(CC='n', GN='n', NS='n', BU='n',FA='n',LD='n',BZ='n',FC='n',FP='n',RP='n',PP='n',KA='n',SC='n',TS='n',NV='n',MA='n',LB='n',AF='n',HU='n',Price='n'), panel = TRUE, print.level=TRUE)
P
str(P)
